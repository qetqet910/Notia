# DEV_LOG_20251208.md - Troubleshooting Notia White Screen Issue

**Date:** 2025년 12월 8일 월요일

## 배경
사용자가 Tauri 기반의 Notia 앱 빌드 후 **흰 화면**이 지속되는 문제를 보고했습니다. 이 문제는 웹 배포 버전에서도 재현되기도 했습니다.

---

## 작업 내용 요약 (타임라인)

...(중략)...

### v1.3.21 -> v1.3.22: [최종 해결] Tauri 빌드 시 PWA 완전 제거 및 최적화

*   **문제**: `v1.3.21`까지의 시도에도 불구하고 Tauri 앱에서 흰 화면이 지속됨. `dist` 폴더 확인 결과, `VitePWA` 플러그인을 비활성화했음에도 `public/` 디렉토리에 정적으로 존재하는 `service-worker.js`와 `manifest.json` 파일이 `dist/`로 복사되고 있었음. Tauri(Webview2) 환경에서 서비스 워커가 로드되려고 하면 보안 및 프로토콜 충돌로 인해 JS 실행 자체가 차단되어 흰 화면이 발생함.
*   **해결 시도**:
    1.  **`vite.config.ts` 함수형 전환**: `process.env` 및 `mode`를 더 정확히 감지하기 위해 `defineConfig`를 함수형으로 변경. `TAURI_PLATFORM` 환경 변수 체크 추가.
    2.  **플러그인 필터링**: `plugins` 배열에서 `!isTauri && VitePWA(...)`와 `.filter(Boolean)`을 사용하여 Tauri 빌드 시 PWA 플러그인을 메모리 상에서도 완전히 제거.
    3.  **물리적 파일 삭제 (Post-build)**: `public/`에서 복사되는 PWA 관련 파일들(`service-worker.js`, `manifest.json` 등)을 빌드 완료 후 `npx rimraf`를 통해 물리적으로 삭제하도록 `package.json` 스크립트 수정.
    4.  **메모리 최적화**: Codespaces 등 메모리 제한 환경에서 빌드 실패를 방지하기 위해 `NODE_OPTIONS=--max-old-space-size=4096` 적용.
*   **결과**: `dist/` 폴더 내에 서비스 워커와 매니페스트 파일이 존재하지 않으며, `index.html`에서도 관련 참조가 모두 제거됨. 순수한 React 앱으로 빌드되어 Tauri 환경에서의 충돌 요인이 원천 제거됨.

---

## 현재 상황 및 결론

Tauri에서의 흰 화면 문제는 **"네이티브 앱 환경에서 PWA 서비스 워커가 실행되려고 시도했기 때문"**으로 확정되었습니다. `v1.3.22`를 통해 이를 완전히 해결했습니다.

**향후 주의 사항**:
*   Tauri 앱 빌드 시에는 반드시 `npm run build:tauri`를 사용하여 전용 빌드 프로세스를 거쳐야 합니다.
*   PWA 기능은 웹(`build:web`) 배포 시에만 활성화됩니다.
